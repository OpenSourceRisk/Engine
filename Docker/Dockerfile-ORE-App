#ARG TEST_TAG=latest
ARG CMAKE_BUILD_TYPE=Release
ARG ORE_HELPER_VERSION
ARG ORE_VERSION

FROM ${DOCKER_REPO}env_ore:${ORE_VERSION} as env_ore
FROM ${DOCKER_REPO}ore-helper:${ORE_HELPER_VERSION}

RUN mkdir -p /ore/App

COPY --from=env_ore /usr/local/bin /ore/App

#COPY --from=env_ore /usr/lib/aarch64-linux-gnu /usr/lib/aarch64-linux-gnu
COPY --from=env_ore /usr/lib/x86_64-linux-gnu/libboost* /usr/lib/x86_64-linux-gnu
COPY --from=env_ore /usr/lib/x86_64-linux-gnu/libOpenCL* /usr/lib/x86_64-linux-gnu
RUN true
COPY --from=env_ore /usr/local/lib /usr/local/lib
COPY --from=env_ore /usr/include/boost/ /usr/include/boost

WORKDIR /ore
ENV LD_LIBRARY_PATH=/usr/local/lib:./

CMD bash
